[2025-06-09T05:33:12.475+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-06-09T05:33:12.499+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: image_ocr_v2.img_preprocess_task manual__2025-06-09T05:33:04.523423+00:00 map_index=2 [queued]>
[2025-06-09T05:33:12.512+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: image_ocr_v2.img_preprocess_task manual__2025-06-09T05:33:04.523423+00:00 map_index=2 [queued]>
[2025-06-09T05:33:12.513+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1
[2025-06-09T05:33:12.530+0000] {taskinstance.py:2890} INFO - Executing <Mapped(_PythonDecoratedOperator): img_preprocess_task> on 2025-06-09 05:33:04.523423+00:00
[2025-06-09T05:33:12.538+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=3004) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-06-09T05:33:12.541+0000] {standard_task_runner.py:72} INFO - Started process 3016 to run task
[2025-06-09T05:33:12.540+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'image_ocr_v2', 'img_preprocess_task', 'manual__2025-06-09T05:33:04.523423+00:00', '--job-id', '90', '--raw', '--subdir', 'DAGS_FOLDER/test_dag.py', '--cfg-path', '/tmp/tmpb56dvi07', '--map-index', '2']
[2025-06-09T05:33:12.549+0000] {standard_task_runner.py:105} INFO - Job 90: Subtask img_preprocess_task
[2025-06-09T05:33:12.598+0000] {task_command.py:467} INFO - Running <TaskInstance: image_ocr_v2.img_preprocess_task manual__2025-06-09T05:33:04.523423+00:00 map_index=2 [running]> on host 85194d6fbd18
[2025-06-09T05:33:12.689+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='image_ocr_v2' AIRFLOW_CTX_TASK_ID='img_preprocess_task' AIRFLOW_CTX_EXECUTION_DATE='2025-06-09T05:33:04.523423+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-09T05:33:04.523423+00:00'
[2025-06-09T05:33:12.692+0000] {taskinstance.py:732} INFO - ::endgroup::
[2025-06-09T05:33:12.695+0000] {logging_mixin.py:190} INFO - empty map check {} {'process_id': 'a7822c5c-9ca0-477f-a38c-cf5a236aec6b', 'folder_path': '0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b', 'step_list': [{'name': 'gray1', 'param': {}}, {'name': 'cache', 'param': {'key': 'gray1'}}, {'name': 'binary2', 'param': {}}, {'name': 'calc_angle1', 'param': {'key': 'angle1'}}, {'name': 'load', 'param': {'key': 'gray1'}}, {'name': 'rotate', 'param': {'key': 'angle1'}}, {'name': 'cache', 'param': {'key': 'rotate1'}}, {'name': 'save', 'param': {'key': 'rotate1'}}, {'name': 'binary2', 'param': {}}, {'name': 'calc_angle2', 'param': {'key': 'angle2'}}, {'name': 'load', 'param': {'key': 'rotate1'}}, {'name': 'rotate', 'param': {'key': 'angle2'}}, {'name': 'save', 'param': {'key': 'rotate2'}}, {'name': 'scale1', 'param': {'width': 500, 'height': 500}}, {'name': 'binary2', 'param': {}}, {'name': 'morphology1', 'param': {}}, {'name': 'save', 'param': {'key': 'classify_preprocess'}}], 'result_file_list': []}
[2025-06-09T05:33:12.695+0000] {logging_mixin.py:190} INFO - step : gray1
[2025-06-09T05:33:12.725+0000] {logging_mixin.py:190} INFO - step : cache
[2025-06-09T05:33:12.865+0000] {logging_mixin.py:190} INFO - step : binary2
[2025-06-09T05:33:12.897+0000] {logging_mixin.py:190} INFO - step : calc_angle1
[2025-06-09T05:33:13.048+0000] {logging_mixin.py:190} INFO - Angle counts: Counter({0.0: 550, 0.5070290609147756: 90, 0.5070290609147747: 11, 1.0230301886678357: 11, 0.6740368979845073: 8, 45.0: 8, 0.6700955222245284: 7, 0.9710219310791666: 4, 1.023030188667832: 4, 0.5161642297648399: 3, 0.9710219310791643: 3, 0.7538483330707635: 3, 0.8814039965821377: 3, 1.0416266760099742: 3, 0.8680514497455426: 3, 2.1210963966614536: 3, 0.5115558665870452: 2, 1.0809241866606811: 2, 0.5968094512291771: 2, 0.5208563745019461: 2, 0.9992436702573002: 2, 1.1233027140754217: 2, 0.5846305207051756: 2, 0.8069294551023745: 2, 0.9391909457355799: 2, 0.9963478965049255: 2, 0.6510603802294952: 2, 0.5161642297648366: 2, 1.0416266760099688: 2, 0.7161599454704085: 2, 3.1798301198642345: 2, 1.0609116902642277: 2, 0.682060393172652: 2, 5.1173148499726295: 2, 89.18154453831139: 2, 16.73875855842764: 2, 0.9240453527727062: 2, 0.5968094512291772: 2, 2.0825652797308845: 2, 87.83892051177362: 2, 5.194428907734803: 2, 0.9240453527727084: 2, 0.8425242607404145: 2, 1.1457628381751033: 2, 0.5115558665870411: 2, 0.8243428208451604: 1, 1.128834796660641: 1, 0.8012873301070158: 1, 7.938264523545486: 1, 0.9934688562825755: 1, 0.5617053325665466: 1, 0.758840124268545: 1, 0.9469514467734683: 1, 0.9443504035796337: 1, 8.01481925115025: 1, 1.0322446915657366: 1, 0.5729386976834832: 1, 0.7298430640241094: 1, 1.231977402639728: 1, 1.0609116902642342: 1, 0.8550973962667143: 1, 0.6986943829834713: 1, 0.7345210342548114: 1, 0.5846305207051778: 1, 0.6437457141753669: 1, 0.8550973962667232: 1, 0.98776039963981: 1, 0.5787255656077621: 1, 0.6095065766751959: 1, 7.907162702958458: 1, 0.6700955222245337: 1, 0.6295986084102668: 1, 0.5672664098579361: 1, 0.5405101871306666: 1, 0.7957235527392754: 1, 0.8680514497455363: 1, 0.9093804491991335: 1, 0.5354589855645338: 1, 0.8951737102110744: 1, 0.9793196543394874: 1, 1.0809241866606887: 1, 89.09061955080085: 1, 7.294196308540862: 1, 0.6820603931726481: 1, 0.5672664098579344: 1, 89.21517539700811: 1, 0.658543177563603: 1, 88.97696981133217: 1, 87.18444331578877: 1, 89.02897806892084: 1, 0.5405101871306641: 1, 0.9548412538721887: 1, 1.7357045889283889: 1, 88.40885972880541: 1, 1.8881880067409305: 1, 16.959847022065045: 1, 3.721313264749753: 1, 5.492324557127432: 1, 1.0050860052541708: 1, 0.6160599083992302: 1, 2.2457425658950716: 1, 88.26429541107161: 1, 1.7623910236605125: 1, 88.93908830973577: 1, 89.11859600341786: 1, 1.169139327907419: 1, 2.0952525646238485: 1, 89.22577983507195: 1, 10.06068979532297: 1, 89.27477570094075: 1, 2.245742565895071: 1, 6.115503566285398: 1, 16.880330165523855: 1, 88.36342295838328: 1, 4.635463426902646: 1, 0.7848246029918897: 1, 2.202598161765806: 1, 0.6740368979845053: 1, 0.5509039792185729: 1, 1.4878675288277787: 1, 0.795723552739274: 1, 17.553544826339873: 1, 87.95459151111277: 1, 86.47854662307776: 1, 4.398705354995532: 1, 3.2245226065199075: 1, 86.8778695378843: 1, 2.2025981617658053: 1, 2.7263109939062673: 1, 2.17474411461005: 1, 88.15238973400541: 1, 68.19859051364818: 1, 86.68221883166515: 1, 88.8542371618249: 1, 86.9335144988741: 1, 89.40934278535333: 1, 87.87890360333854: 1, 1.5481576989779677: 1, 0.9093804491991415: 1, 0.7345210342548154: 1, 3.122130462115708: 1, 87.2297842027998: 1, 85.42607874009914: 1, 87.83892051177364: 1, 1.9091524329963763: 1, 1.1017061152063747: 1, 86.76029970389789: 1, 89.10482628978893: 1, 3.3018656744350032: 1, 5.599339336520558: 1, 0.6986943829834757: 1, 0.5729386976834859: 1, 17.255111002091954: 1})
[2025-06-09T05:33:13.050+0000] {logging_mixin.py:190} INFO - step : load
[2025-06-09T05:33:13.051+0000] {logging_mixin.py:190} INFO - step : rotate
[2025-06-09T05:33:13.118+0000] {logging_mixin.py:190} INFO - step : cache
[2025-06-09T05:33:13.260+0000] {logging_mixin.py:190} INFO - step : save
[2025-06-09T05:33:13.261+0000] {logging_mixin.py:190} INFO - file_copy: /opt/***/data/temp/3435e551-771a-4c36-b2dc-9e01d432024f.png /opt/***/data/result/0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b/rotate1.png
[2025-06-09T05:33:13.272+0000] {logging_mixin.py:190} INFO - step : binary2
[2025-06-09T05:33:13.342+0000] {logging_mixin.py:190} INFO - step : calc_angle2
[2025-06-09T05:33:14.510+0000] {logging_mixin.py:190} INFO - step : load
[2025-06-09T05:33:14.511+0000] {logging_mixin.py:190} INFO - step : rotate
[2025-06-09T05:33:14.589+0000] {logging_mixin.py:190} INFO - step : save
[2025-06-09T05:33:14.798+0000] {logging_mixin.py:190} INFO - file_copy: /opt/***/data/temp/42f577fb-c310-4f06-a972-06e726295268.png /opt/***/data/result/0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b/rotate2.png
[2025-06-09T05:33:14.803+0000] {logging_mixin.py:190} INFO - step : scale1
[2025-06-09T05:33:14.868+0000] {logging_mixin.py:190} INFO - step : binary2
[2025-06-09T05:33:14.869+0000] {logging_mixin.py:190} INFO - step : morphology1
[2025-06-09T05:33:14.870+0000] {logging_mixin.py:190} INFO - step : save
[2025-06-09T05:33:14.871+0000] {logging_mixin.py:190} INFO - file_copy: /opt/***/data/temp/2ac2569c-327f-409b-a459-273b3803967a.png /opt/***/data/result/0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b/classify_preprocess.png
[2025-06-09T05:33:14.873+0000] {python.py:240} INFO - Done. Returned value was: {'file_id': '0e15a3fb-6c8c-4ae9-9128-a457d83d5800', 'file_path': '/opt/***/data/upload/Gas Engine 점검일지_ 2021년 2월.pdf-image-005.jpg', 'preprocess_list': [{'process_id': 'a7822c5c-9ca0-477f-a38c-cf5a236aec6b', 'folder_path': '0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b', 'step_list': [{'name': 'gray1', 'param': {}}, {'name': 'cache', 'param': {'key': 'gray1'}}, {'name': 'binary2', 'param': {}}, {'name': 'calc_angle1', 'param': {'key': 'angle1'}}, {'name': 'load', 'param': {'key': 'gray1'}}, {'name': 'rotate', 'param': {'key': 'angle1'}}, {'name': 'cache', 'param': {'key': 'rotate1'}}, {'name': 'save', 'param': {'key': 'rotate1'}}, {'name': 'binary2', 'param': {}}, {'name': 'calc_angle2', 'param': {'key': 'angle2'}}, {'name': 'load', 'param': {'key': 'rotate1'}}, {'name': 'rotate', 'param': {'key': 'angle2'}}, {'name': 'save', 'param': {'key': 'rotate2'}}, {'name': 'scale1', 'param': {'width': 500, 'height': 500}}, {'name': 'binary2', 'param': {}}, {'name': 'morphology1', 'param': {}}, {'name': 'save', 'param': {'key': 'classify_preprocess'}}], 'result_file_list': [{'rotate1': '/opt/***/data/result/0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b/rotate1.png'}, {'rotate2': '/opt/***/data/result/0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b/rotate2.png'}, {'classify_preprocess': '/opt/***/data/result/0e15a3fb-6c8c-4ae9-9128-a457d83d5800/a7822c5c-9ca0-477f-a38c-cf5a236aec6b/classify_preprocess.png'}]}]}
[2025-06-09T05:33:14.902+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-06-09T05:33:14.903+0000] {taskinstance.py:353} INFO - Marking task as SUCCESS. dag_id=image_ocr_v2, task_id=img_preprocess_task, run_id=manual__2025-06-09T05:33:04.523423+00:00, map_index=2, execution_date=20250609T053304, start_date=20250609T053312, end_date=20250609T053314
[2025-06-09T05:33:14.985+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-06-09T05:33:14.999+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-06-09T05:33:15.001+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
